#!/usr/bin/env bash
# File generated by pre-commit: https://pre-commit.com

if [ -d .git/hooks/configs ]; then
    CONFIG_DIR=.git/hooks/configs
else
    CONFIG_DIR=$(git config init.templateDir)/hooks/configs
fi

# start templated
ARGS=(hook-impl --config=${CONFIG_DIR}/pre-commit-config.yaml --hook-type=pre-commit)
# end templated

HERE="$(cd "$(dirname "$0")" && pwd)"
ARGS+=(--hook-dir "$HERE" -- "$@")

if command -v pre-commit > /dev/null; then
    exec pre-commit "${ARGS[@]}"
elses
    echo '`pre-commit` not found.  please run `pip install pre-commit` to install pre-commit' 1>&2
    exit 1
fi

# Check branch
branch_pattern='^((master)|(main)|(develop)|(feature/.*)|(bugfix/.*)|(release/.*)|(hotfix/.*))$'
branch=$(git branch --show-current)
if [[ $branch =~ ${branch_pattern} ]]
then
    echo "Check branch name... [passed]"
else
    echo >&2 "Branch name $branch is not right format in Vincent Driessen's branching model. Get help: https://nvie.com/posts/a-successful-git-branching-model"
    exit 1
fi
